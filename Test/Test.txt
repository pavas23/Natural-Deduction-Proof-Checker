Test Case 1:

(((p>q)>r)^s)/P
(p>q)/P
s/P
((p>q)>r)/^e1/1
p/P
q/>e/2/5
~r/P
~(p>q)/MT/4/7
(s^p)/^i/3/5
(s+r)/+i1/3


Test Case 2:

((a>b)^(d+f))/P
~(a^(s>r))/P
((a>b)+d)/P
(a>b)/^e1/1
(((a>b)+d)+~w)/+i1/3
((a>b)>~(s+f))/P
~(s+f)/>e/6/4
(~(s+f)+~(a>f))/+i1/7
(d+f)/^e2/1
((d+f)^~(s+f))/^i/9/7
~b/P
~a/MT/4/11
((a^f)>(g+j))/P
~(g+j)/P
~(a^f)/MT/13/14
(((d+f)>(e^g))+(d+f))/+i2/9
((a>(b^c))^((h+f)>(d+~z)))/P
(a>(b^c))/^e1/17
((h+f)>(d+~z))/^e2/17
(~b^((h+f)>(d+~z)))/^i/11/19


Test Case 3:

((a>b)^(d>(e^(g+h))))/P
(a>b)/^e1/1
(d>(e^(g+h)))/^e2/1
a/P
b/>e/2/4
d/P
(e^(g+h))/>e/3/6
(g+h)/^e2/7
e/^e1/7
~b/P
~a/MT/2/10
((e^(g+h))^e)/^i/9/8


Test Case 4:

(((a>b)>(d+f))^((e+g)>(r+(f>(r^v)))))/P
((a>b)>(d+f))/^e1/1
((e+g)>(r+(f>(r^v))))/^e2/1
(a>b)/P
(d+f)/>e/2/4
~b/P
~a/MT/4/6
(e+g)/P
(r+(f>(r^v)))/>e/3/8
(a^(b^(f^(x+z))))/P
(b^(f^(x+z)))/^e2/10
(f^(x+z))/^e2/11
((f^(x+z))+(d+~a))/+i1/12
(~a^~b)/^i/7/6
(e+g)/P
(r+(f>(r^v)))/>e/3/15
((e+g)^(~a^~b))/^i/8/14
(s>(f>(g>(k>(q>(i>(y^(a>(c+(x^(a+(d>s))))))))))))/P
s/P
(f>(g>(k>(q>(i>(y^(a>(c+(x^(a+(d>s)))))))))))/>e/18/19
f/P
(g>(k>(q>(i>(y^(a>(c+(x^(a+(d>s))))))))))/>e/20/21
g/P
(k>(q>(i>(y^(a>(c+(x^(a+(d>s)))))))))/>e/22/23
k/P
(q>(i>(y^(a>(c+(x^(a+(d>s))))))))/>e/24/25
q/P
(i>(y^(a>(c+(x^(a+(d>s)))))))/>e/26/27
i/P
(y^(a>(c+(x^(a+(d>s))))))/>e/28/29
(a>(c+(x^(a+(d>s)))))/^e2/30
a/P
(c+(x^(a+(d>s))))/>e/31/32
((c+(x^(a+(d>s))))+q)/+i1/33
(s+f)/+i1/19
